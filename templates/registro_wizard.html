{% extends "base.html" %}
{% block title %}{{ titulo or "Registro" }}{% endblock %}
{% block content %}

<div class="max-w-3xl mx-auto card">
  <div class="card-pad">
    <!-- Stepper -->
    <div class="flex items-center gap-3 mb-4 text-sm">
      <div class="flex items-center gap-2">
        <div class="h-7 w-7 rounded-full flex items-center justify-center
                    {% if paso>=1 %}bg-brand-600 text-white{% else %}bg-gray-200{% endif %}">1</div>
        <span class="font-medium {% if paso>=1 %}text-gray-800{% else %}text-gray-400{% endif %}">Seleccionar</span>
      </div>
      <div class="h-px flex-1 bg-gray-200"></div>
      <div class="flex items-center gap-2">
        <div class="h-7 w-7 rounded-full flex items-center justify-center
                    {% if paso>=2 %}bg-brand-600 text-white{% else %}bg-gray-200{% endif %}">2</div>
        <span class="font-medium {% if paso>=2 %}text-gray-800{% else %}text-gray-400{% endif %}">Completar</span>
      </div>
      <div class="h-px flex-1 bg-gray-200"></div>
      <div class="flex items-center gap-2">
        <div class="h-7 w-7 rounded-full flex items-center justify-center
                    {% if paso>=3 %}bg-brand-600 text-white{% else %}bg-gray-200{% endif %}">3</div>
        <span class="font-medium {% if paso>=3 %}text-gray-800{% else %}text-gray-400{% endif %}">Confirmación</span>
      </div>
    </div>

    {# ---- PASO 1 ---- #}
    {% if paso == 1 %}
      <h1 class="text-xl font-semibold mb-2">¿Qué deseas registrar?</h1>
      <form method="post" class="space-y-4">
        {{ form.hidden_tag() }}
        <div class="flex flex-wrap gap-3">
          {% for opt in form.modo %}
            <label class="inline-flex items-center gap-2 btn btn-ghost">
              {{ opt() }}
              <span>{{ opt.label.text }}</span>
            </label>
          {% endfor %}
        </div>
        {{ form.continuar(class="btn btn-primary") }}
      </form>

    {# ---- PASO 2 (ALUMNO) ---- #}
    {% elif paso == 2 and modo == 'alumno' %}
      <h1 class="text-xl font-semibold mb-2">Registro de Alumno/a</h1>
      <form method="post" class="grid gap-4">
        {{ form.hidden_tag() }}
        <div class="grid md:grid-cols-2 gap-4">
          <div>
            <label class="field-label">Nombre completo</label>
            {{ form.nombre(class="field-input") }}
          </div>
          <div>
            <label class="field-label">Correo</label>
            {{ form.email(class="field-input", type="email") }}
          </div>
        </div>
        <div>
          <label class="field-label">Código de estudiante</label>
          {{ form.student_code(class="field-input") }}
        </div>
        <div class="grid md:grid-cols-2 gap-4">
          <div>
            <label class="field-label">Contraseña</label>
            {{ form.password(class="field-input", type="password") }}
          </div>
          <div>
            <label class="field-label">Confirmar contraseña</label>
            {{ form.password2(class="field-input", type="password") }}
          </div>
        </div>
        <div class="flex gap-2">
          <a href="{{ url_for('registro_wizard.registro', paso=1) }}" class="btn btn-ghost">Volver</a>
          {{ form.enviar(class="btn btn-primary") }}
        </div>
      </form>

    {# ---- PASO 2 (ACADÉMICO) ---- #}
    {% elif paso == 2 and modo == 'academico' %}
      <h1 class="text-xl font-semibold mb-2">Registro de Académico/a</h1>
      <form method="post" class="grid gap-4">
        {{ form.hidden_tag() }}
        <div class="grid md:grid-cols-2 gap-4">
          <div>
            <label class="field-label">Nombre completo</label>
            {{ form.nombre(class="field-input") }}
          </div>
          <div>
            <label class="field-label">Correo @academicos.udg.mx</label>
            {{ form.email(class="field-input", type="email", placeholder="nombre@academicos.udg.mx") }}
          </div>
        </div>
        <div class="grid md:grid-cols-2 gap-4">
          <div>
            <label class="field-label">Contraseña</label>
            {{ form.password(class="field-input", type="password") }}
          </div>
          <div>
            <label class="field-label">Confirmar contraseña</label>
            {{ form.password2(class="field-input", type="password") }}
          </div>
        </div>
        <p class="text-xs text-gray-600">* Las claves de equipos se asignan después, desde tu panel.</p>
        <div class="flex gap-2">
          <a href="{{ url_for('registro_wizard.registro', paso=1) }}" class="btn btn-ghost">Volver</a>
          {{ form.enviar(class="btn btn-primary") }}
        </div>
      </form>

    {# ---- PASO 2 (EQUIPO) ---- #}
    {% elif paso == 2 and modo == 'equipo' %}
      <h1 class="text-xl font-semibold mb-2">Registro de Equipo</h1>
      <form method="post" class="grid gap-4">
        {{ form.hidden_tag() }}
        <div class="grid md:grid-cols-2 gap-4">
          <div>
            <label class="field-label">Grado</label>
            {{ form.grado(class="field-input", type="number") }}
          </div>
          <div>
            <label class="field-label">Nombre del Cartel / Proyecto</label>
            {{ form.nombre_cartel(class="field-input") }}
          </div>
        </div>
        <div>
          <label class="field-label">Códigos de estudiante (uno por línea)</label>
          {{ form.integrantes_codigos(class="field-input", rows="6", placeholder="A12345\nB98765") }}
        </div>
        <div class="flex gap-2">
          <a href="{{ url_for('registro_wizard.registro', paso=1) }}" class="btn btn-ghost">Volver</a>
          {{ form.enviar(class="btn btn-primary") }}
        </div>
      </form>

    {# ---- PASO 3 ---- #}
    {% elif paso == 3 %}
      <h1 class="text-xl font-semibold mb-2">¡Listo!</h1>
      <p class="text-sm text-gray-700 mb-4">
        {{ confirm_msg or "Registro completado." }}
      </p>
      <div class="flex gap-2">
        <a href="{{ url_for('auth.login_general') }}" class="btn btn-primary">Ir a Login</a>
        <a href="{{ url_for('main.home') }}" class="btn btn-ghost">Volver al inicio</a>
      </div>
    {% endif %}
  </div>
</div>

{% endblock %}
